<div class="register-container">
  <!-- Resumo p√≥s-registro -->
  <div *ngIf="mostrarResumo && usuarioCadastrado" class="register-summary">
    <h2 class="summary-title">Conta criada com sucesso üéâ</h2>
    <p class="summary-subtitle">Aqui est√£o os detalhes do seu cadastro:</p>
    <div class="summary-card">
      <div class="summary-row"><span class="label">Nome:</span><span class="value">{{ usuarioCadastrado.firstName }} {{ usuarioCadastrado.lastName }}</span></div>
      <div class="summary-row"><span class="label">Email:</span><span class="value">{{ usuarioCadastrado.email }}</span></div>
      <div class="summary-row" *ngIf="usuarioCadastrado.phone"><span class="label">Telefone:</span><span class="value">{{ usuarioCadastrado.phone }}</span></div>
      <div class="summary-row" *ngIf="usuarioCadastrado.document"><span class="label">CPF:</span><span class="value">{{ usuarioCadastrado.document }}</span></div>
      <div class="summary-row"><span class="label">Verificado:</span><span class="value" [class]="usuarioCadastrado.isEmailVerified ? 'status-ok' : 'status-pending'">{{ usuarioCadastrado.isEmailVerified ? 'Sim' : 'Pendente' }}</span></div>
      <div class="summary-row"><span class="label">Ativo:</span><span class="value" [class]="usuarioCadastrado.isActive ? 'status-ok' : 'status-error'">{{ usuarioCadastrado.isActive ? 'Sim' : 'Inativo' }}</span></div>
      <div class="summary-info" *ngIf="!usuarioCadastrado.isEmailVerified">Enviamos um email de verifica√ß√£o. Verifique sua caixa de entrada.</div>
    </div>
    <div class="summary-actions">
      <button type="button" class="btn-dashboard" (click)="proceedToDashboard()">Ir para Dashboard</button>
      <button type="button" class="btn-new" (click)="mostrarResumo=false; usuarioCadastrado=null;">Cadastrar outro usu√°rio</button>
    </div>
  </div>

  <ng-container *ngIf="!mostrarResumo">
  <div class="register-header">
    <h2 class="register-title">Criar nova conta</h2>
    <p class="register-subtitle">Cadastre-se para salvar seus cart√µes e facilitar pagamentos futuros</p>
  </div>

  <!-- Erro geral -->
  <div *ngIf="erroGeral" class="alert alert-error">
    <div class="alert-icon error-icon"></div>
    <span>{{ erroGeral }}</span>
  </div>

  <form (ngSubmit)="onSubmit()" class="register-form">
    <!-- Nome e Sobrenome -->
    <div class="form-row">
      <div class="form-group">
        <label for="firstName" class="form-label">Nome *</label>
        <input
          id="firstName"
          type="text"
          placeholder="Seu nome"
          [(ngModel)]="dadosCadastro.firstName"
          (input)="onInputChange('firstName')"
          [class]="'form-input ' + (erros['firstName'] ? 'input-error' : '')"
          name="firstName"
          autocomplete="given-name"
        />
        <span *ngIf="erros['firstName']" class="error-message">{{ erros['firstName'] }}</span>
      </div>

      <div class="form-group">
        <label for="lastName" class="form-label">Sobrenome *</label>
        <input
          id="lastName"
          type="text"
          placeholder="Seu sobrenome"
          [(ngModel)]="dadosCadastro.lastName"
          (input)="onInputChange('lastName')"
          [class]="'form-input ' + (erros['lastName'] ? 'input-error' : '')"
          name="lastName"
          autocomplete="family-name"
        />
        <span *ngIf="erros['lastName']" class="error-message">{{ erros['lastName'] }}</span>
      </div>
    </div>

    <!-- Email -->
    <div class="form-group">
      <label for="email" class="form-label">Email *</label>
      <input
        id="email"
        type="email"
        placeholder="seu@email.com"
        [(ngModel)]="dadosCadastro.email"
        (input)="onInputChange('email')"
        [class]="'form-input ' + (erros['email'] ? 'input-error' : '')"
        name="email"
        autocomplete="email"
      />
      <span *ngIf="erros['email']" class="error-message">{{ erros['email'] }}</span>
    </div>

    <!-- Telefone e CPF -->
    <div class="form-row">
      <div class="form-group">
        <label for="phone" class="form-label">Telefone</label>
        <input
          id="phone"
          type="tel"
          placeholder="(11) 99999-9999"
          [(ngModel)]="dadosCadastro.phone"
          (input)="onInputChange('phone')"
          [class]="'form-input ' + (erros['phone'] ? 'input-error' : '')"
          name="phone"
          autocomplete="tel"
        />
        <span *ngIf="erros['phone']" class="error-message">{{ erros['phone'] }}</span>
      </div>

      <div class="form-group">
        <label for="document" class="form-label">CPF</label>
        <input
          id="document"
          type="text"
          placeholder="000.000.000-00"
          [(ngModel)]="dadosCadastro.document"
          (input)="onInputChange('document')"
          [class]="'form-input ' + (erros['document'] ? 'input-error' : '')"
          name="document"
          maxlength="14"
        />
        <span *ngIf="erros['document']" class="error-message">{{ erros['document'] }}</span>
      </div>
    </div>

    <!-- Senha -->
    <div class="form-group">
      <label for="password" class="form-label">Senha *</label>
      <div class="password-input-group">
        <input
          id="password"
          [type]="mostrarSenha ? 'text' : 'password'"
          placeholder="Sua senha"
          [(ngModel)]="dadosCadastro.password"
          (input)="onInputChange('password')"
          [class]="'form-input ' + (erros['password'] ? 'input-error' : '')"
          name="password"
          autocomplete="new-password"
        />
        <button
          type="button"
          class="password-toggle"
          (click)="togglePasswordVisibility()"
        >
          <div [class]="mostrarSenha ? 'eye-off-icon' : 'eye-icon'"></div>
        </button>
      </div>
      
      <!-- Indicador de for√ßa da senha -->
  <div *ngIf="dadosCadastro.password" class="password-strength">
        <div class="strength-bar">
          <div [class]="'strength-fill ' + getPasswordStrength()"></div>
        </div>
        <span [class]="'strength-text ' + getPasswordStrength()">
          {{ getPasswordStrength() === 'weak' ? 'Fraca' : 
             getPasswordStrength() === 'medium' ? 'M√©dia' : 'Forte' }}
        </span>
      </div>
      
      <span *ngIf="erros['password']" class="error-message">{{ erros['password'] }}</span>
    </div>

    <!-- Confirmar Senha -->
    <div class="form-group">
      <label for="confirmPassword" class="form-label">Confirmar Senha *</label>
      <div class="password-input-group">
        <input
          id="confirmPassword"
          [type]="mostrarConfirmarSenha ? 'text' : 'password'"
          placeholder="Confirme sua senha"
          [(ngModel)]="confirmarSenha"
          (input)="onInputChange('confirmPassword')"
          [class]="'form-input ' + (erros['confirmPassword'] ? 'input-error' : '')"
          name="confirmPassword"
          autocomplete="new-password"
        />
        <button
          type="button"
          class="password-toggle"
          (click)="toggleConfirmPasswordVisibility()"
        >
          <div [class]="mostrarConfirmarSenha ? 'eye-off-icon' : 'eye-icon'"></div>
        </button>
      </div>
      <span *ngIf="erros['confirmPassword']" class="error-message">{{ erros['confirmPassword'] }}</span>
    </div>

    <!-- Termos -->
    <div class="form-group">
      <div class="checkbox-group">
        <input
          id="acceptTerms"
          type="checkbox"
          [(ngModel)]="aceitarTermos"
          (change)="onInputChange('terms')"
          [class]="'form-checkbox ' + (erros['terms'] ? 'checkbox-error' : '')"
          name="acceptTerms"
        />
        <label for="acceptTerms" class="checkbox-label">
          Aceito os <a href="/terms" target="_blank" class="link">termos de uso</a> 
          e <a href="/privacy" target="_blank" class="link">pol√≠tica de privacidade</a>
        </label>
      </div>
      <span *ngIf="erros['terms']" class="error-message">{{ erros['terms'] }}</span>
    </div>

    <!-- Bot√£o de registro -->
    <button
      type="submit"
      class="btn-register"
      [disabled]="carregando"
    >
      <div *ngIf="carregando" class="spinner-small"></div>
      <span>{{ carregando ? 'Criando conta...' : 'Criar conta' }}</span>
    </button>
  </form>

  <!-- Link para login -->
  <div class="switch-auth">
    <span>J√° tem uma conta? </span>
    <button
      type="button"
      class="switch-link"
      (click)="onSwitchToLogin()"
    >
      Entrar
    </button>
  </div>
  </ng-container>
</div>
